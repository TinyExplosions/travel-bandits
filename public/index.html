<!DOCTYPE html>
<html>

<head>
    <style>
    .wrapper {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
    }

    .wrapper>* {
        padding: 0.5em;
    }

    h3 {
        padding: 0;
        margin: 0;
    }

    #map {
        flex-grow: 1;
    }
    </style>
    <!-- Map Icons -->
    <link rel="stylesheet" type="text/css" href="/public/map-icons/css/map-icons.css">
    <script type="text/javascript" src="/public/map-icons/js/map-icons.js"></script>
</head>

<body>
    <div class="wrapper">
        <header class="page-header">
            <h3>My Google Maps Demo</h3>
        </header>
        <!--The div element for the map -->
        <div id="map"></div>
        <script>
        var locations = [{
                "city": "London",
                "country": "UK",
                "name": "The Hydrant",
                "address": "Equitable House, 1 Monument St, London EC3R 8BG",
                "coordinates": [51.510267,-0.086104],
                "description": {
                    "Comment": "London Office local pub, will find folk there most nights."
                },
                "type": "pub",
                "link": { "homepage": "https://www.thehydrant.co.uk" }
            },
            {
                "city": "London",
                "country": "UK",
                "name": "Premier Inn London Bank (Tower)",
                "address": "20 St Mary at Hill, London EC3R 8EE",
                "coordinates": [51.509056,-0.083058],
                "description": {
                    "Comment": "Close hotel to office, not usually too expensive."
                },
                "type": "hotel",
                "link": { "homepage": "https://www.premierinn.com/gb/en/hotels/england/greater-london/london/london-bank-tower.html?cid=GLBC_LONMON" }
            },
            {
                "city": "London",
                "country": "UK",
                "name": "Black Sheep Coffee",
                "address": "31 Eastcheap, London EC3M 1DE",
                "coordinates": [51.5106158,-0.0837789],
                "description": {
                    "Comment": "Nice coffee, close to office, 'nuff said."
                },
                "type": "coffee",
                "link": { "homepage": "https://leavetheherdbehind.com" }
            },
            {
                "city": "London",
                "country": "UK",
                "name": "Brewdog Tower Hill",
                "address": "21 Great Tower St, London EC3R 5AR",
                "coordinates": [51.5098997,-0.0807109],
                "description": {
                    "Comment": "An alternate local for the London Office, worth a visit."
                },
                "type": "pub",
                "link": { "homepage": "https://www.brewdog.com/bars/uk/brewdog-outpost-tower-hill" }
            },
            {
                "city": "London",
                "country": "UK",
                "name": "London Office",
                "address": "Peninsular House, 30-36 Monument St, London EC3R 8NB",
                "coordinates": [51.509916,-0.085498],
                "description": {
                    "Comment": "Red Hat London Office"
                },
                "type": "office",
                "link": { "homepage": "https://www.redhat.com/en/about/office-locations" }
            },
            {
                "city": "Farnborough",
                "country": "UK",
                "name": "Farnborough Office",
                "address": "200 Fowler Avenue Farnborough, Hampshire GU14 7JP",
                "coordinates": [51.283309,-0.75775],
                "description": {
                    "Comment": "Red Hat Farnborough Office, often abbreviated to FAB"
                },
                "type": "office",
                "link": { "homepage": "https://www.redhat.com/en/about/office-locations" }
            }
        ]

        var icons = {
          "office": "/public/markers/office.png",
          "coffee": "/public/markers/coffee.png",
          "pub": "/public/markers/pub.png",
          "hotel": "/public/markers/hotel.png",
          "restaurant": "/public/markers/restaurant.png",
          "information": "/public/markers/information.png"
        }







        // Initialize and add the map
        function initMap() {
            // The location of Monument
            var monument = { lat: 51.509990, lng: -0.085620 };
            var fab = { lat: 51.284780, lng: -0.758490 };
            // The map, centered at Monument
            var map = new google.maps.Map(
                document.getElementById('map'), { zoom: 16, center: monument });
            // The marker, positioned at Monument

            var markers = locations.map(function(location, i) {
                console.log("lat", location.coordinates[0]);
                return new google.maps.Marker({
                    position: { lat: parseFloat(location.coordinates[0]), lng: parseFloat(location.coordinates[1]) },
                    // label: location.name,
                    map: map,
                    icon: icons[location.type] || icons['information']
                });
            });

            // var markerCluster = new MarkerClusterer(map, markers, {
            //     imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m'
            // });
            // var marker = new google.maps.Marker({ position: monument, map: map, icon: "http://localhost:8080/public/redhat.png" });
            // var fabMarker = new google.maps.Marker({ position: fab, map: map, icon: "http://localhost:8080/public/redhat.png" });
        }
        </script>
        <script src="/public/markerClusterer.js"></script>
        <!--Load the API from the specified URL
      * The async attribute allows the browser to render the page while the API loads
      * The key parameter will contain your own API key (which is not needed for this tutorial)
      * The callback parameter executes the initMap() function
      -->
        <script async defer src="https://maps.googleapis.com/maps/api/js?v=3&key=AIzaSyAbaFuSO_Z-2HceI05s1jiO-ktOU3FCSzk&callback=initMap">
        </script>
    </div>
</body>

</html>